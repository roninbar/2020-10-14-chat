(this["webpackJsonpclient-react-redux"]=this["webpackJsonpclient-react-redux"]||[]).push([[0],{209:function(e){e.exports=JSON.parse('[{"id":1,"picture":"/images/1.png","name":"\u05d0\u05d5\u05db\u05dc","lastMessage":"You were added"},{"id":2,"picture":"/images/2.jpg","name":"\u05e2\u05d2\u05dc\u05d5\u05ea","lastMessage":"\u05d7\u05d7\u05d7\u05d7\u05d7\u05d7","typing":true,"chat":[{"message":"first message","date":"19-09-20 19:31","from":"Me"},{"message":"long message, long message, long message, long message...","date":"19-09-20 19:31","from":"someone"},{"message":"short message","date":"19-09-20 19:32","from":"someone"},{"message":"hello world","date":"19-09-20 19:32","from":"Me"},{"message":"Typing...","typing":true,"date":"19-09-20 19:32","from":"Me"}]},{"id":3,"picture":"/images/3.jpg","name":"\u05e7\u05e4\u05d4 \u05d5\u05de\u05d0\u05e4\u05d4\u2615\ud83c\udf6a","lastMessage":"\u05d5\u05d5\u05d0\u05d9, \u05de\u05e2\u05e0\u05d9\u05d9\u05df \u05de\u05d4 \u05d9\u05d4\u05d9\u05d4 \u05d1\u05db\u05d9\u05e4\u05d5\u05e8 \ud83d\ude05"},{"id":4,"picture":"/images/4.jpg","name":"\u05d1\u05d5\u05e7\u05e8\u05d4\u05de\u05d5\u05d1\u05d9\u05e5\u05f3 \ud83d\ude1b","lastMessage":"\u05d1\u05d5\u05e7\u05e8 \u05d8\u05d5\u05d1 \u05d5\u05d7\u05d2 \u05e9\u05de\u05d7 \u05d0\u05dc\u05de\u05d5\u05d2\u05d9\u2764"},{"id":5,"picture":"/images/1.png","name":"\u05d0\u05d5\u05db\u05dc","lastMessage":"You were added"},{"id":6,"picture":"/images/2.jpg","name":"\u05e2\u05d2\u05dc\u05d5\u05ea","lastMessage":"\u05d7\u05d7\u05d7\u05d7\u05d7\u05d7","typing":true}]')},231:function(e,t,a){e.exports=a(390)},232:function(e,t,a){},258:function(e,t){},275:function(e,t,a){},276:function(e,t,a){},277:function(e,t,a){},280:function(e,t){},282:function(e,t){},296:function(e,t){},298:function(e,t){},326:function(e,t){},328:function(e,t){},329:function(e,t){},335:function(e,t){},337:function(e,t){},355:function(e,t){},357:function(e,t){},369:function(e,t){},372:function(e,t){},389:function(e,t,a){},390:function(e,t,a){"use strict";a.r(t);a(232);var n=a(9),r=a(48),c=a(15),s=a.n(c),o=a(25),i=a(32),l=a(204),u=a.n(l),m=a(96),d=a.n(m),p=u()();p.on("connect",(function(){d()("chat:socket")("Connected.")})),p.on("disconnect",(function(){d()("chat:socket")("Disconnected.")})),p.on("chat",(function(e){d()("chat:socket")("Received message:",e)}));var f=p,g=(Object(i.b)("chat/loadAllMessages",Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))),Object(i.b)("chat/sendMessage",(function(e){f.emit("chat",e)}))),v=Object(i.c)({name:"chat",initialState:{messages:[]},reducers:{truncateMessages:function(e){e.messages.length=0},sendMessage:function(e,t){var a=t.payload,n=a.time,r=a.sender,c=a.text;e.messages.push({time:n,sender:r,text:c,status:"sent"})},receiveMessage:function(e,t){var a=t.payload,n=a.time,r=a.sender,c=a.text;e.messages.push({time:n,sender:r,text:c,status:"received"})}},extraReducers:Object(n.a)({},g.pending,(function(e,t){var a=t.meta,n=a.requestId,c=a.arg;e.messages.push(Object(r.a)(Object(r.a)({id:n},c),{},{status:"pending"}))}))}),h=v.actions,b=(h.truncateMessages,h.sendMessage,h.receiveMessage),E=v.reducer,O=a(0),j=a.n(O),w=a(12),y=a.n(w),x=a(36),k=a(90),S=a(16),N=a(20),C=a(453),_=a(436),M=a(437),I=a(438),T=a(439),R=a(440),A=a(441),D=a(429),B=a(434),P=a(435),L=a(218),W=a(2),F=a(432),U=Object(D.a)((function(e){return{card:{margin:e.spacing(1),backgroundColor:function(e){return"received"===e.status?"white":"#dcf8c6"}}}}));function q(e){var t=e.children,a=Object(W.a)(e,["children"]),n=U(e);return j.a.createElement(F.a,Object.assign({},a,{className:n.card}),t)}var J=Object(D.a)((function(e){return{cardContent:{display:"flex",flexFlow:"column nowrap"},sender:{alignSelf:"flex-start",color:"#aaa"},time:{alignSelf:"flex-end",color:"#aaa"}}}));function V(e){var t=e.messages,a=J();return j.a.createElement(B.a,{item:!0,component:"main",container:!0,direction:"column",wrap:"nowrap"},t.map((function(e){var t=e.id,n=e.sender,r=e.time,c=e.text,s=e.status;return j.a.createElement(B.a,{item:!0,container:!0,direction:"row",justify:"pending"===s||"sent"===s?"flex-start":"flex-end",key:t},j.a.createElement(B.a,{item:!0,xs:8},j.a.createElement(q,{sender:n,status:s},j.a.createElement(P.a,{className:a.cardContent},"received"===s&&j.a.createElement(L.a,{variant:"caption",className:a.sender},n),j.a.createElement(L.a,{variant:"body1"},c),j.a.createElement(L.a,{variant:"caption",className:a.time},r)))))})))}a(275);var Y={sendMessageAsync:g},z=Object(x.b)((function(e){return{username:e.user.name,messages:e.chat.messages}}),Y)((function(e){var t=e.username,a=e.messages,n=e.sendMessageAsync,r=Object(O.useState)(""),c=Object(N.a)(r,2),s=c[0],o=c[1];Object(O.useEffect)((function(){i.current&&i.current.scrollIntoView()}),[a]);var i=Object(O.useRef)(null);return j.a.createElement("div",{className:"chat"},j.a.createElement("div",{className:"chat__header"},j.a.createElement(C.a,{src:(void 0,null)}),j.a.createElement("div",{className:"chat__headerInfo"},j.a.createElement("h3",null,(void 0,"Room name"))),j.a.createElement("div",{className:"chat__headerRight"},j.a.createElement(_.a,null,j.a.createElement(M.a,null)),j.a.createElement(_.a,null,j.a.createElement(I.a,null)))),j.a.createElement("div",{className:"chat__body"},j.a.createElement(V,{messages:a}),j.a.createElement("div",{ref:i})),j.a.createElement("div",{className:"chat__footer"},j.a.createElement(_.a,null,j.a.createElement(T.a,null)),j.a.createElement(_.a,null,j.a.createElement(R.a,null)),j.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=new Date;n({time:a.toLocaleTimeString("he-IL"),sender:t,text:s}),o("")}},j.a.createElement("input",{type:"text",value:s,onChange:function(e){var t=e.target.value;return o(t)},placeholder:"Type a message"}),j.a.createElement("button",{type:"submit"},"Send")),j.a.createElement(_.a,null,j.a.createElement(A.a,null))))})),G=a(443),K=a(452),$=a(455),H=a(454),Q=a(391),X=a(442),Z=a(211),ee=a.n(Z),te=a(210),ae=a.n(te),ne=a(212),re=a.n(ne),ce=a(214),se=a.n(ce),oe=a(209);a(276);var ie=function(e){var t,a,n,r;return e.typing&&(r=j.a.createElement("div",{className:"sidebarChat__typing"},"Typing...")),j.a.createElement("div",{className:"sidebarChat",onClick:function(){e.onSideBarClicked(e)}},j.a.createElement(C.a,{src:null!==(t=e.picture)&&void 0!==t?t:void 0}),j.a.createElement("div",{className:"sidebarChat__info"},j.a.createElement("h2",null,null!==(a=e.name)&&void 0!==a?a:"Room Name"),j.a.createElement("p",null,null!==(n=e.lastMessage)&&void 0!==n?n:"Room Name"),r))};a(277);var le,ue=function(e){var t=e.onSideBarClicked,a=e.onLogOut,n=j.a.useState(!1),r=Object(N.a)(n,2),c=r[0],s=r[1],o=j.a.useRef(null);function i(e){var t;(null===(t=o.current)||void 0===t?void 0:t.contains(e.target))||s(!1)}function l(e){i(e),a()}function u(e){t(e)}function m(e){"Tab"===e.key&&(e.preventDefault(),s(!1))}var d=oe.map((function(e,t){return j.a.createElement(ie,{id:e.id,key:t,typing:e.typing,picture:e.picture,name:e.name,lastMessage:e.lastMessage,onSideBarClicked:u})})),p=j.a.useRef(c);return j.a.useEffect((function(){!0===p.current&&!1===c&&o.current.focus(),p.current=c}),[c]),j.a.createElement("div",{className:"sidebar"},j.a.createElement("div",{className:"sidebar__header"},j.a.createElement(C.a,{src:"/images/me.png"}),j.a.createElement("div",{className:"sidebar__headerRight"},j.a.createElement(_.a,{title:"Status"},j.a.createElement(ae.a,null)),j.a.createElement(_.a,{title:"New Chat"},j.a.createElement(ee.a,null)),j.a.createElement(_.a,{title:"Menu",ref:o,"aria-controls":c?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:function(){s((function(e){return!e}))}},j.a.createElement(re.a,null)),j.a.createElement(X.a,{open:c,anchorEl:o.current,role:void 0,transition:!0,disablePortal:!0},(function(e){var t=e.TransitionProps,a=e.placement;return j.a.createElement(K.a,Object.assign({},t,{style:{transformOrigin:"bottom"===a?"center top":"center bottom"}}),j.a.createElement(Q.a,null,j.a.createElement(G.a,{onClickAway:i},j.a.createElement(H.a,{autoFocusItem:c,id:"menu-list-grow",onKeyDown:m},j.a.createElement($.a,{onClick:i},"New Group"),j.a.createElement($.a,{onClick:i},"Create a Room"),j.a.createElement($.a,{onClick:i},"Profile"),j.a.createElement($.a,{onClick:i},"Archived"),j.a.createElement($.a,{onClick:i},"Starred"),j.a.createElement($.a,{onClick:i},"Setting"),j.a.createElement($.a,{onClick:l},"Log Out")))))})))),j.a.createElement("div",{className:"sidebar__search"},j.a.createElement("div",{className:"sidebar__searchContainer"},j.a.createElement(se.a,null),j.a.createElement("input",{type:"text",placeholder:"Search or start new chat"}))),j.a.createElement("div",{className:"sidebar__chats"},d))},me=a(215),de=(Object(i.b)("user/signup",function(){var e=Object(o.a)(s.a.mark((function e(t){var a,n,r,c,o,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,r=t.firstName,c=t.lastName,e.next=3,be("POST","/api/user",{firstName:r,lastName:c,username:a,password:n});case 3:if(o=e.sent,i=o.status,l=o.statusText,!(200<=i&&i<300)){e.next=10;break}return e.abrupt("return",{status:i,statusText:l});case 10:throw new Error("".concat(i," ").concat(l));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(i.b)("user/login",function(){var e=Object(o.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.password,e.abrupt("return",be("POST","/api/auth/login",{username:a,password:n}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),pe=Object(i.b)("user/logout",Object(o.a)(s.a.mark((function e(){var t,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve("POST","/api/auth/logout",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:if(t=e.sent,a=t.status,n=t.statusText,!(200<=a&&a<300)){e.next=9;break}return e.abrupt("return",n);case 9:throw new Error("".concat(a," ").concat(n));case 10:case"end":return e.stop()}}),e)})))),fe=Object(i.c)({name:"user",initialState:{pending:!1,error:!1,info:null},extraReducers:(le={},Object(n.a)(le,de.pending,(function(e){localStorage.removeItem("token"),e.info=null,e.error=!1,e.pending=!0})),Object(n.a)(le,de.fulfilled,(function(e,t){var a=t.payload.token;e.pending=!1,e.info=Object(me.decode)(a),localStorage.setItem("token",a)})),Object(n.a)(le,de.rejected,(function(e,t){var a=t.error;e.pending=!1,e.error=a})),Object(n.a)(le,pe.pending,(function(e){e.info=null,e.error=!1,e.pending=!0})),Object(n.a)(le,pe.fulfilled,(function(e){e.pending=!1,e.error=!1,localStorage.removeItem("token")})),Object(n.a)(le,pe.rejected,(function(e,t){var a=t.error;e.pending=!1,e.error=a,localStorage.removeItem("token")})),le)}),ge=(fe.actions.setUser,fe.reducer);function ve(e,t){return he.apply(this,arguments)}function he(){return(he=Object(o.a)(s.a.mark((function e(t,a){var n,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:{},e.next=3,fetch(a,Object(r.a)(Object(r.a)({},n),{},{method:t}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t,a){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(o.a)(s.a.mark((function e(t,a,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new URLSearchParams(Object.entries(n)),e.next=3,Oe(t,a,{body:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t){return je.apply(this,arguments)}function je(){return(je=Object(o.a)(s.a.mark((function e(t,a){var n,c,o,i,l=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>2&&void 0!==l[2]?l[2]:{},e.next=3,fetch(a,Object(r.a)({method:t},n));case 3:if(c=e.sent,o=c.status,i=c.statusText,!(200<=o&&o<300)){e.next=11;break}return e.next=8,c.json();case 8:return e.abrupt("return",e.sent);case 11:throw new Error("".concat(o," ").concat(i));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var we=Object(x.b)(null,{logOutAsync:pe})((function(e){var t=e.logOutAsync,a=e.history,n=Object(O.useState)({}),r=Object(N.a)(n,2),c=r[0],i=r[1];function l(){return(l=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:a.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return j.a.createElement("div",{className:"app"},j.a.createElement("div",{className:"app__body"},j.a.createElement(ue,{onSideBarClicked:function(e){(null===e||void 0===e?void 0:e.id)&&i(e)},onLogOut:function(){return l.apply(this,arguments)}}),j.a.createElement(z,{chatData:c})))}));var ye=Object(x.b)((function(e){return{username:e.user.name}}),null)((function(e){var t=e.component,a=Object(W.a)(e,["component"]);return j.a.createElement(S.b,Object.assign({},a,{render:function(e){return localStorage.getItem("token")?j.a.createElement(t,e):j.a.createElement(S.a,{to:"/login"})}}))})),xe=a(456),ke=a(447),Se=a(451),Ne=a(444),Ce=a(445),_e=a(446),Me=a(448),Ie=a(449),Te=a(216),Re=a.n(Te),Ae=a(450),De=Object(D.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),Be=Object(x.b)((function(e){return{error:e.user.error}}),{logInAsync:de})((function(e){var t=e.error,a=e.logInAsync,n=De(),r=Object(S.g)(),c=Object(O.useState)(""),i=Object(N.a)(c,2),l=i[0],u=i[1],m=Object(O.useState)(""),d=Object(N.a)(m,2),p=d[0],f=d[1];function g(){return(g=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,a({username:l,password:p});case 3:n=e.sent,n.error||r.push("/");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return j.a.createElement(Ne.a,{component:"main",maxWidth:"xs"},j.a.createElement(Ce.a,null),j.a.createElement("div",{className:n.paper},j.a.createElement(C.a,{className:n.avatar},j.a.createElement(Re.a,null)),j.a.createElement(L.a,{component:"h1",variant:"h5"},"Sign in"),j.a.createElement("form",{onSubmit:function(e){return g.apply(this,arguments)},className:n.form,noValidate:!0},j.a.createElement(Ie.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,autoComplete:"username",autoFocus:!0,label:"Username",type:"text",name:"username",value:l,onChange:function(e){var t=e.target.value;u(t)}}),j.a.createElement(Ie.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,autoComplete:"current-password",label:"Password",type:"password",name:"password",value:p,onChange:function(e){var t=e.target.value;f(t)}}),j.a.createElement(_e.a,{control:j.a.createElement(Se.a,{value:"remember",color:"primary"}),label:"Remember me"}),j.a.createElement(ke.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:n.submit},"Sign In"),j.a.createElement(B.a,{container:!0},j.a.createElement(B.a,{item:!0,xs:!0},j.a.createElement(Me.a,{href:"#",variant:"body2"},"Forgot password?")),j.a.createElement(B.a,{item:!0},j.a.createElement(Me.a,{href:"#",variant:"body2"},"Don't have an account? Sign Up"))))),j.a.createElement(xe.a,{open:Boolean(t)},j.a.createElement(Ae.a,{variant:"filled",severity:"error",elevation:6},null===t||void 0===t?void 0:t.message)))}));a(389);var Pe=function(){return j.a.createElement(k.a,null,j.a.createElement(S.d,null,j.a.createElement(S.b,{exact:!0,path:"/login",component:Be}),j.a.createElement(ye,{exact:!0,path:"/",component:we})))},Le=Object(i.a)({reducer:{chat:E,user:ge}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));f.on("chat",(function(e){Le.dispatch(b(e))})),y.a.render(j.a.createElement(j.a.StrictMode,null,j.a.createElement(x.a,{store:Le},j.a.createElement(Pe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[231,1,2]]]);
//# sourceMappingURL=main.12307b8e.chunk.js.map